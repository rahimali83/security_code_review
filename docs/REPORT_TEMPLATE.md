# SecureCode Guardian Report Format

This document describes the JSON report format generated by SecureCode Guardian after each security scan.

## Report Location

Reports are saved to:
- **Timestamped reports**: `.securecode/reports/report-{timestamp}.json`
- **Latest report**: `.securecode/reports/latest-report.json`

The latest report is used for stateful vulnerability tracking between scans.

## Report Structure

```json
{
  "reportId": "REPORT-1234567890-5678",
  "projectName": "MyProject",
  "projectPath": "/path/to/project",
  "scanStartTime": 1234567890000,
  "scanEndTime": 1234567895000,
  "scanDuration": 5000,
  "version": "1.0.0",
  "previousReportId": "REPORT-1234567800-1234",
  "rulesExecuted": 25,
  "filesScanned": 150,
  "linesScanned": 50000,
  "vulnerabilities": [...],
  "summary": {...},
  "complianceStatus": {...}
}
```

## Field Descriptions

### Top-Level Fields

| Field | Type | Description |
|-------|------|-------------|
| `reportId` | string | Unique identifier for this report |
| `projectName` | string | Name of the scanned project |
| `projectPath` | string | Absolute path to project directory |
| `scanStartTime` | number | Unix timestamp (ms) when scan started |
| `scanEndTime` | number | Unix timestamp (ms) when scan completed |
| `scanDuration` | number | Duration in milliseconds |
| `version` | string | Report format version |
| `previousReportId` | string? | ID of previous report (for tracking) |
| `rulesExecuted` | number | Number of rules executed |
| `filesScanned` | number | Number of files analyzed |
| `linesScanned` | number | Total lines of code scanned |
| `vulnerabilities` | array | List of detected vulnerabilities |
| `summary` | object | Statistical summary |
| `complianceStatus` | object | Compliance framework status |

## Vulnerability Object

Each vulnerability in the `vulnerabilities` array has the following structure:

```json
{
  "id": "VULN-1234567890-1234",
  "ruleId": "SEC-001",
  "ruleName": "Hardcoded Secrets Detection",
  "severity": "critical",
  "category": "secrets",
  "description": "Hardcoded password detected",
  "filePath": "/path/to/file.java",
  "lineNumber": 42,
  "columnNumber": 8,
  "codeSnippet": "    String password = \"secret123\";",
  "compliance": [...],
  "quickFix": {...},
  "status": "new",
  "firstDetected": 1234567890000,
  "lastDetected": 1234567890000,
  "fingerprint": "a1b2c3d4e5f6g7h8"
}
```

### Vulnerability Fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Unique vulnerability identifier |
| `ruleId` | string | ID of the rule that detected this |
| `ruleName` | string | Human-readable rule name |
| `severity` | enum | `critical`, `high`, `medium`, `low`, `info` |
| `category` | enum | Category of the vulnerability |
| `description` | string | Detailed description |
| `filePath` | string | Absolute path to affected file |
| `lineNumber` | number | Line number where issue occurs |
| `columnNumber` | number | Column number (if available) |
| `codeSnippet` | string | Code excerpt showing the issue |
| `compliance` | array | Relevant compliance mappings |
| `quickFix` | object? | Suggested fix (if available) |
| `status` | enum | `new`, `persistent`, `closed`, `fixed`, `ignored` |
| `firstDetected` | number | Unix timestamp when first seen |
| `lastDetected` | number | Unix timestamp when last seen |
| `fingerprint` | string | Unique hash for tracking |

### Vulnerability Status

The `status` field tracks vulnerability lifecycle:

- **`new`**: Found in current scan, not in previous scan
- **`persistent`**: Found in both current and previous scan
- **`closed`**: Found in previous scan, not in current scan (issue resolved)
- **`fixed`**: Manually marked as fixed
- **`ignored`**: Manually marked to ignore

## Summary Object

Statistical overview of the scan results:

```json
{
  "total": 25,
  "new": 5,
  "persistent": 18,
  "closed": 2,
  "bySeverity": {
    "critical": 3,
    "high": 8,
    "medium": 10,
    "low": 4,
    "info": 0
  },
  "byCategory": {
    "secrets": 3,
    "injection": 5,
    "cryptography": 2,
    "security": 15
  },
  "byStatus": {
    "new": 5,
    "persistent": 18,
    "closed": 2
  }
}
```

### Summary Fields

| Field | Type | Description |
|-------|------|-------------|
| `total` | number | Total active vulnerabilities (excludes closed) |
| `new` | number | New vulnerabilities in this scan |
| `persistent` | number | Continuing vulnerabilities |
| `closed` | number | Resolved vulnerabilities |
| `bySeverity` | object | Count by severity level |
| `byCategory` | object | Count by category |
| `byStatus` | object | Count by status |

## Compliance Status

Compliance assessment for supported frameworks:

```json
{
  "pci_dss": {
    "framework": "pci_dss",
    "totalControls": 10,
    "passedControls": 7,
    "failedControls": 3,
    "compliancePercentage": 70.0,
    "violations": [...]
  },
  "soc2": {
    "framework": "soc2",
    "totalControls": 8,
    "passedControls": 6,
    "failedControls": 2,
    "compliancePercentage": 75.0,
    "violations": [...]
  }
}
```

### Compliance Status Fields

| Field | Type | Description |
|-------|------|-------------|
| `framework` | string | Compliance framework name |
| `totalControls` | number | Total controls checked |
| `passedControls` | number | Controls with no violations |
| `failedControls` | number | Controls with violations |
| `compliancePercentage` | number | Percentage of controls passed |
| `violations` | array | List of violating vulnerabilities |

## Compliance Tag

Compliance information attached to vulnerabilities:

```json
{
  "framework": "pci_dss",
  "control": "6.5.1",
  "requirement": "Injection flaws, particularly SQL injection"
}
```

## Quick Fix

Suggested remediation for a vulnerability:

```json
{
  "type": "suggest",
  "description": "Use parameterized queries instead of string concatenation",
  "replacement": null
}
```

### Quick Fix Types

- **`remove`**: Suggests removing the problematic code
- **`replace`**: Provides replacement code (in `replacement` field)
- **`suggest`**: Provides guidance in description
- **`refactor`**: Suggests architectural changes

## Example Complete Report

```json
{
  "reportId": "REPORT-1698765432-8901",
  "projectName": "SecureApp",
  "projectPath": "/Users/dev/projects/SecureApp",
  "scanStartTime": 1698765432000,
  "scanEndTime": 1698765437000,
  "scanDuration": 5000,
  "version": "1.0.0",
  "previousReportId": "REPORT-1698679032-7890",
  "rulesExecuted": 25,
  "filesScanned": 150,
  "linesScanned": 50000,
  "vulnerabilities": [
    {
      "id": "VULN-1698765433-1234",
      "ruleId": "SEC-001",
      "ruleName": "Hardcoded Secrets Detection",
      "severity": "critical",
      "category": "secrets",
      "description": "Hardcoded password detected",
      "filePath": "/Users/dev/projects/SecureApp/src/main/java/Config.java",
      "lineNumber": 42,
      "columnNumber": 8,
      "codeSnippet": "    String dbPassword = \"password123\";",
      "compliance": [
        {
          "framework": "pci_dss",
          "control": "8.2",
          "requirement": "Do not use hardcoded passwords or credentials"
        },
        {
          "framework": "owasp",
          "control": "A07:2021",
          "requirement": "Identification and Authentication Failures"
        }
      ],
      "quickFix": {
        "type": "suggest",
        "description": "Move secrets to environment variables or a secure configuration service",
        "replacement": null
      },
      "status": "new",
      "firstDetected": 1698765433000,
      "lastDetected": 1698765433000,
      "fingerprint": "f1e2d3c4b5a69788"
    },
    {
      "id": "VULN-1698765433-5678",
      "ruleId": "SEC-002",
      "ruleName": "SQL Injection Vulnerability",
      "severity": "critical",
      "category": "injection",
      "description": "Potential SQL injection via string concatenation",
      "filePath": "/Users/dev/projects/SecureApp/src/main/java/UserDAO.java",
      "lineNumber": 78,
      "columnNumber": 12,
      "codeSnippet": "    String query = \"SELECT * FROM users WHERE id = \" + userId;",
      "compliance": [
        {
          "framework": "pci_dss",
          "control": "6.5.1",
          "requirement": "Injection flaws, particularly SQL injection"
        },
        {
          "framework": "owasp",
          "control": "A03:2021",
          "requirement": "Injection"
        }
      ],
      "quickFix": {
        "type": "suggest",
        "description": "Use parameterized queries or prepared statements instead of string concatenation",
        "replacement": null
      },
      "status": "persistent",
      "firstDetected": 1698679033000,
      "lastDetected": 1698765433000,
      "fingerprint": "a9b8c7d6e5f41234"
    }
  ],
  "summary": {
    "total": 25,
    "new": 5,
    "persistent": 18,
    "closed": 2,
    "bySeverity": {
      "critical": 3,
      "high": 8,
      "medium": 10,
      "low": 4
    },
    "byCategory": {
      "secrets": 3,
      "injection": 5,
      "cryptography": 2,
      "security": 10,
      "quality": 5
    },
    "byStatus": {
      "new": 5,
      "persistent": 18,
      "closed": 2
    }
  },
  "complianceStatus": {
    "pci_dss": {
      "framework": "pci_dss",
      "totalControls": 10,
      "passedControls": 7,
      "failedControls": 3,
      "compliancePercentage": 70.0,
      "violations": [
        {
          "id": "VULN-1698765433-1234",
          "ruleId": "SEC-001",
          "ruleName": "Hardcoded Secrets Detection",
          "severity": "critical"
        }
      ]
    },
    "owasp": {
      "framework": "owasp",
      "totalControls": 8,
      "passedControls": 6,
      "failedControls": 2,
      "compliancePercentage": 75.0,
      "violations": []
    }
  }
}
```

## Using Reports

### Programmatic Access

Reports can be parsed and analyzed programmatically:

```javascript
const report = JSON.parse(fs.readFileSync('.securecode/reports/latest-report.json'));
console.log(`Total vulnerabilities: ${report.summary.total}`);
console.log(`Critical issues: ${report.summary.bySeverity.critical}`);
```

### Trend Analysis

Compare reports over time to track security improvements:

```bash
# List all reports
ls -la .securecode/reports/

# Compare vulnerability counts
jq '.summary.total' .securecode/reports/*.json
```

### CI/CD Integration

Use reports in CI/CD pipelines:

```yaml
# Example GitHub Actions
- name: Run Security Scan
  run: ./gradlew runSecurityScan

- name: Check for Critical Issues
  run: |
    CRITICAL=$(jq '.summary.bySeverity.critical // 0' .securecode/reports/latest-report.json)
    if [ "$CRITICAL" -gt 0 ]; then
      echo "Found $CRITICAL critical vulnerabilities"
      exit 1
    fi
```

### Dashboard Integration

Import reports into security dashboards or tracking systems:

- Parse JSON reports
- Extract metrics
- Visualize trends
- Track remediation progress

## Report Versioning

The `version` field indicates the report format version. Future versions may add new fields while maintaining backward compatibility.

Current version: `1.0.0`

## Notes

- Reports are cumulative - they include all active vulnerabilities
- The `fingerprint` field enables tracking the same vulnerability across scans
- Closed vulnerabilities are included in reports to show remediation progress
- Reports can be safely committed to version control (they contain no secrets)
